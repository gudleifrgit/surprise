<!doctype html>
<html lang="ru">
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Sensorium ¬∑ mini-quest</title>
<meta name="theme-color" content="#000000">
<style>
  :root{--bg:#000;--fg:#eaeaea;--muted:#2a2a2a}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font:16px/1.55 system-ui,Inter,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}
  .card{max-width:720px;width:100%;padding:22px 20px;border:1px solid var(--muted);border-radius:16px;background:rgba(255,255,255,.02);text-align:center}
  .btn{display:inline-block;margin:6px 5px;padding:10px 16px;border-radius:12px;border:1px solid var(--muted);background:#111;color:#eee;cursor:pointer}
  .btn:active{transform:scale(.98)}
  .fade{animation:fade .25s ease}
  @keyframes fade{from{opacity:.3;transform:translateY(4px)}to{opacity:1;transform:none}}
</style>
<body>
<div class="wrap"><div class="card fade" id="stage"></div></div>

<script>
const tg = window.Telegram?.WebApp;
tg?.ready();

const el = document.getElementById("stage");

function send(mode, day) {
  const data = {type:"sensorium_choice", mode, day};
  tg?.sendData(JSON.stringify(data));
  console.log("Sent to bot:", data);
  el.className="card fade";
  el.innerHTML = `
    <p>–ñ–¥—É —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º, ü•∞ –∫—Ä–∞—Å–æ—Ç–∫–∞</p>
    <p><strong>–£–≤–∏–¥–∏–º—Å—è ${day==="thu"?"–≤ —á–µ—Ç–≤–µ—Ä–≥ –≤–µ—á–µ—Ä–æ–º":day==="fri"?"–≤ –ø—è—Ç–Ω–∏—Ü—É –≤–µ—á–µ—Ä–æ–º":"–Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö"}</strong></p>`;
}

function chooseDay(mode) {
  el.className="card fade";
  el.innerHTML = `
    <p>${mode==="museum"?"üòç –û—Ç–ª–∏—á–Ω–æ. –¢–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–π:":"–¢–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ—É–∂–∏–Ω–∞–µ–º. –ö–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ?"}</p>
    <div style="margin-top:8px">
      <button class="btn" onclick="send('${mode}','thu')">–í–µ—á–µ—Ä —á–µ—Ç–≤–µ—Ä–≥–∞</button>
      <button class="btn" onclick="send('${mode}','fri')">–í–µ—á–µ—Ä –ø—è—Ç–Ω–∏—Ü—ã</button>
      <button class="btn" onclick="send('${mode}','wknd')">–í—ã—Ö–æ–¥–Ω—ã–µ</button>
    </div>`;
}

function renderStep(i){
  const steps=[
    {t:"–ü—Ä–∏–≤–µ—Ç, –û—á–∞—Ä–æ–≤–∞—à–∫–∞. –ú—ã –æ–±–∞ –ª—é–±–∏–º —Ö–æ—Ä—Ä–æ—Ä—ã –∏ –Ω–µ–æ–±—ã—á–Ω—ã–µ –≤–µ—â–∏"},
    {t:"–í —Ç–µ–º–Ω–æ—Ç–µ –µ—Å—Ç—å —á—Ç–æ-—Ç–æ –ø—Ä–∏—Ç—è–≥–∞—Ç–µ–ª—å–Ω–æ–µ<br>–∏ –Ω–∞—Å—Ç–æ—è—â–µ–µ"},
    {t:"–ö–æ–≥–¥–∞ —Å–≤–µ—Ç –≥–∞—Å–Ω–µ—Ç,<br>–≤—Å—ë —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≥–ª—É–±–∂–µ"},
    {t:"–ü—Ä–∏–≥–ª–∞—à–∞—é —Ç–µ–±—è –≤ –º—É–∑–µ–π —Ç–µ–º–Ω–æ—Ç—ã ‚Äî <strong>–°–µ–Ω—Å–æ—Ä–∏—É–º</strong>",buttons:true}
  ];
  const s=steps[i];
  el.className="card fade";
  if(s.buttons){
    el.innerHTML=`<p>${s.t}</p>
      <button class="btn" onclick="chooseDay('museum')">üòá –í–∞—É, —è —Å–æ–≥–ª–∞—Å–Ω–∞</button>
      <button class="btn" onclick="chooseDay('dinner')">üòÖ –Ø —Ç–∞–º —É–∂–µ –±—ã–ª–∞</button>`;
  }else{
    el.innerHTML=`<p>${s.t}</p><button class="btn" onclick="renderStep(${i+1})">–î–∞–ª—å—à–µ</button>`;
  }
}

renderStep(0);
</script>
</body>
</html>
